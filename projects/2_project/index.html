<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Anomaly Detection Hierarchical Deep Learning Model | Nico Vila </title> <meta name="author" content="Nico Vila"> <meta name="description" content="Hierarchical Deep Learning model for anomaly detection in water consumption data, presented with an interactive web visualization."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://niicovila.github.io/projects/2_project/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Nico</span> Vila </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title" style="text-align: justify;">Anomaly Detection Hierarchical Deep Learning Model</h1> <p class="post-description" style="text-align: justify;">Hierarchical Deep Learning model for anomaly detection in water consumption data, presented with an interactive web visualization.</p> </header> <article class="text-justify"> <p>Water distribution networks in urban environments face the crucial challenge of detecting anomalies like leaks, excessive consumption, or meter errors. These anomalies often go unnoticed until significant water loss occurs. This project tackles this critical issue by presenting a novel, adaptable deep learning meta-model specifically designed for anomaly detection in water meter data.</p> <h3 id="leveraging-deep-learning-for-time-series">Leveraging Deep Learning for Time Series</h3> <p>Traditional machine learning methods like SVMs and Isolation Forests often struggle with large, time-dependent datasets like water consumption data. Deep learning methods, on the other hand, have shown promising results in anomaly detection tasks. Transformers, in particular, excel at identifying complex patterns in sequential data, making them a strong candidate for this application (<a href="https://arxiv.org/abs/2201.07284" rel="external nofollow noopener" target="_blank">Tuli, Casale, &amp; Jennings, 2022</a>).</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/TranAD-480.webp 480w,/assets/img/TranAD-800.webp 800w,/assets/img/TranAD-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/TranAD.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Transformer AD Architecture" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Transformer AD Architecture </div> <p><a href="https://github.com/niicovila/AgBarDataChallenge" rel="external nofollow noopener" target="_blank">Our model</a>, leveraging the power of LSTMs and Transformers, effectively captures sequential consumption patterns and identifies deviations from normal behavior. This enables early detection of anomalies, potentially leading to significant cost savings for both water companies and consumers, while promoting sustainable water usage.</p> <h3 id="multi-stage-hierarchical-architecture">Multi-Stage Hierarchical Architecture</h3> <p>The core of this project lies in its hierarchical deep learning architecture, specifically designed for anomaly detection in water consumption data. This multi-stage training approach fosters specialization in the later stages while preserving valuable generalizations learned earlier.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/water_architecture-480.webp 480w,/assets/img/water_architecture-800.webp 800w,/assets/img/water_architecture-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/water_architecture.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Hierarchical Architecture" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Multi-Stage Deep Learning Meta Model with Hierarchical Training </div> <p>This balance between adaptability to specific data patterns and overall robustness in anomaly detection is achieved through the integration of three key components:</p> <ul> <li> <p><strong><a href="https://github.com/imperial-qore/TranAD" rel="external nofollow noopener" target="_blank">TranAD</a></strong>: This transformer-based model excels at identifying deviations in time series data. It undergoes a two-phase adversarial training process to capture both short-term trends and long-term dependencies within the data.</p> </li> <li> <p><strong>Multi-LSTM</strong>: This advanced LSTM architecture tackles the challenge of analyzing data across multiple temporal windows simultaneously. This capability is crucial for capturing complex patterns at various time scales, enhancing the model’s accuracy and robustness. Unlike conventional LSTMs, our Multi-LSTM allows for parameterization of both the number of LSTMs and the size of their temporal windows, enabling greater adaptability to diverse data.</p> </li> <li> <p><strong>Multi-Layer Perceptron (MLP)</strong>: This final component acts as a decision layer, evaluating and combining the outputs from the previous stages. By integrating the general insights from earlier training stages with the specialized knowledge of later stages, the MLP provides a single, highly accurate prediction while avoiding overfitting.</p> </li> </ul> <p>The synergy between these components lies at the heart of the model’s power. The precise anomaly detection capabilities of TranAD are complemented by the Multi-LSTM’s ability to handle complex temporal dependencies. Finally, the MLP effectively combines these strengths, leading to a robust and versatile solution for anomaly detection in water consumption data.</p> <div class="row justify-content-sm-center"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/anomaly_visualization-480.webp 480w,/assets/img/anomaly_visualization-800.webp 800w,/assets/img/anomaly_visualization-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/anomaly_visualization.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="LSTM consumption predictions and detected anomalies for a unique time serie" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/ab-tranviz-480.webp 480w,/assets/img/ab-tranviz-800.webp 800w,/assets/img/ab-tranviz-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/ab-tranviz.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Transformer consumption predictions and detected anomalies for a unique time serie" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> LSTM &amp; Transformer consumption predictions and detected anomalies for different time series </div> <ul> <li> <strong>Prophet</strong>: As an additional, external part of the model, we integrated Meta’s Prophet forecasting model in order to forecast future water consumption. In this way, we can both detect anomalies and have a robust predictive tool for consumption that can improve data-based decisions on the user side.</li> </ul> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Prophet-480.webp 480w,/assets/img/Prophet-800.webp 800w,/assets/img/Prophet-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/Prophet.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Prophet Forecast" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Prophet Forecast for a time series. </div> <h3 id="interactive-anomaly-visualization">Interactive Anomaly Visualization</h3> <p>Our project is complemented by a comprehensive web application designed for user-friendly exploration of water consumption patterns and anomalies. This intuitive interface allows visualization of multiple time series simultaneously, aiding in informed decision-making. The application offers in-depth analysis of anomalous data, including visualizations of model predictions alongside actual consumption values, highlighting anomaly points. Furthermore, it empowers users to explore future consumption predictions and geographically visualize anomalies across different areas. By integrating socioeconomic indicators, the web application facilitates strategic decision-making for optimized water resource management.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/visualization.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Web-App Visualization" autoplay="" controls=""></video> </figure> </div> </div> <div class="caption"> Web-App Visualization of Exploratory Data Analysis and Model Predictions and Results </div> <h3 id="references">References</h3> <p>Guha, S., Mishra, N., Roy, G., &amp; Schrijvers, O. (2016, June). <a href="https://proceedings.mlr.press/v48/guha16.html" rel="external nofollow noopener" target="_blank">Robust random cut forest based anomaly detection on streams</a>. In International conference on machine learning (pp. 2712-2721). PMLR.</p> <p>Li, K. L., Huang, H. K., Tian, S. F., &amp; Xu, W. (2003, November). <a href="https://ieeexplore.ieee.org/abstract/document/1260106" rel="external nofollow noopener" target="_blank">Improving one-class SVM for anomaly detection</a>. In Proceedings of the 2003 international conference on machine learning and cybernetics (IEEE Cat. No. 03EX693) (Vol. 5, pp. 3077-3081). IEEE.</p> <p>Lin, S., Clark, R., Birke, R., Schönborn, S., Trigoni, N., &amp; Roberts, S. (2020, May). <a href="https://ieeexplore.ieee.org/abstract/document/9053558" rel="external nofollow noopener" target="_blank">Anomaly detection for time series using vae-lstm hybrid model</a>. In ICASSP 2020-2020 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP) (pp. 4322-4326). Ieee.</p> <p>Liu, F. T., Ting, K. M., &amp; Zhou, Z. H. (2008, December). <a href="https://ieeexplore.ieee.org/abstract/document/4781136" rel="external nofollow noopener" target="_blank">Isolation forest</a>. In 2008 eighth ieee international conference on data mining (pp. 413-422). IEEE.</p> <p>Pang, G., Shen, C., Cao, L., &amp; Hengel, A. V. D. (2021). <a href="https://dl.acm.org/doi/abs/10.1145/3439950" rel="external nofollow noopener" target="_blank">Deep learning for anomaly detection: A review</a>. ACM computing surveys (CSUR), 54(2), 1-38.</p> <p>Su, Y., Zhao, Y., Niu, C., Liu, R., Sun, W., &amp; Pei, D. (2019, July). <a href="https://dl.acm.org/doi/abs/10.1145/3292500.3330672" rel="external nofollow noopener" target="_blank">Robust anomaly detection for multivariate time series through stochastic recurrent neural network</a>. In Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery &amp; data mining (pp. 2828-2837).</p> <p>Tuli, S., Casale, G., &amp; Jennings, N. R. (2022). <a href="https://arxiv.org/abs/2201.07284" rel="external nofollow noopener" target="_blank">Tranad: Deep transformer networks for anomaly detection in multivariate time series data</a>. arXiv preprint arXiv:2201.07284.</p> <p>Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., … &amp; Polosukhin, I. (2017). <a href="https://proceedings.neurips.cc/paper_files/paper/2017/hash/3f5ee243547dee91fbd053c1c4a845aa-Abstract.html" rel="external nofollow noopener" target="_blank">Attention is all you need</a>. Advances in neural information processing systems, 30.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Nico Vila. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>